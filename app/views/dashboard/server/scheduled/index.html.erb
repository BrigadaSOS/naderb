<div class="flex h-full w-full relative">
  <%= render "dashboard/sidebar" %>

  <div class="flex-1 p-3 sm:p-4 md:p-6 overflow-y-auto">
    <!-- Header -->
    <div class="mb-4 sm:mb-6 flex justify-between items-center">
      <div>
        <h2 class="text-xl sm:text-2xl font-bold text-primary mb-2">Scheduled Messages</h2>
        <p class="text-sm sm:text-base text-muted-foreground">Manage automated messages sent to Discord channels</p>
      </div>
      <%= link_to "New Scheduled Message", new_dashboard_server_scheduled_path, class: "px-4 py-2 bg-primary hover:bg-primary/90 text-primary-foreground rounded-md transition-colors" %>
    </div>

    <!-- Messages List -->
    <div class="bg-card rounded-lg overflow-hidden">
      <% if @scheduled_messages.any? %>
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead class="bg-muted border-b border-border">
              <tr>
                <th class="px-4 py-3 text-left text-sm font-semibold text-foreground">Name</th>
                <th class="px-4 py-3 text-left text-sm font-semibold text-foreground">Schedule</th>
                <th class="px-4 py-3 text-left text-sm font-semibold text-foreground">Data Query</th>
                <th class="px-4 py-3 text-left text-sm font-semibold text-foreground">Status</th>
                <th class="px-4 py-3 text-left text-sm font-semibold text-foreground">Actions</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-border">
              <% @scheduled_messages.each do |message| %>
                <tr class="hover:bg-muted/50 transition-colors cursor-pointer" onclick="window.location='<%= dashboard_server_scheduled_path(message) %>'">
                  <td class="px-4 py-3">
                    <div>
                      <p class="font-medium text-foreground"><%= message.name %></p>
                      <% if message.description.present? %>
                        <p class="text-sm text-muted-foreground"><%= truncate(message.description, length: 60) %></p>
                      <% end %>
                    </div>
                  </td>
                  <td class="px-4 py-3">
                    <code class="text-sm bg-muted px-2 py-1 rounded"><%= message.schedule %></code>
                    <p class="text-xs text-muted-foreground mt-1"><%= message.timezone %></p>
                  </td>
                  <td class="px-4 py-3">
                    <% if message.data_query.present? %>
                      <span class="inline-block px-2 py-1 text-xs bg-primary/10 text-primary rounded"><%= message.data_query %></span>
                    <% else %>
                      <span class="text-sm text-muted-foreground">Static</span>
                    <% end %>
                  </td>
                  <td class="px-4 py-3">
                    <% if message.enabled? %>
                      <span class="inline-flex items-center px-2 py-1 text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 rounded">
                        <span class="w-2 h-2 bg-green-500 rounded-full mr-1.5"></span>
                        Enabled
                      </span>
                    <% else %>
                      <span class="inline-flex items-center px-2 py-1 text-xs bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300 rounded">
                        <span class="w-2 h-2 bg-gray-400 rounded-full mr-1.5"></span>
                        Disabled
                      </span>
                    <% end %>
                  </td>
                  <td class="px-4 py-3" onclick="event.stopPropagation()">
                    <div class="flex gap-2">
                      <%= link_to "View", dashboard_server_scheduled_path(message), class: "text-sm text-primary hover:underline" %>
                      <%= link_to "Edit", edit_dashboard_server_scheduled_path(message), class: "text-sm text-primary hover:underline" %>
                    </div>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      <% else %>
        <div class="p-8 text-center">
          <p class="text-muted-foreground mb-4">No scheduled messages yet.</p>
          <%= link_to "Create your first scheduled message", new_dashboard_server_scheduled_path, class: "px-4 py-2 bg-primary hover:bg-primary/90 text-primary-foreground rounded-md transition-colors inline-block" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

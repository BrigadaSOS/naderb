<%= turbo_frame_tag "tags_list" do %>
  <% if tags&.any? %>
    <div
      class="
        grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6
        gap-4
      "
    >
      <% tags.each do |tag| %>
        <% url =
          (
            if can_edit_tag?(tag)
              edit_dashboard_server_tag_path(tag, search: params[:search])
            else
              dashboard_server_tag_path(tag, search: params[:search])
            end
          ) %>

        <%= link_to url, data: { turbo_frame: "tags_content", turbo_action: "advance", testid: "tag-#{tag.name}" }, class: "block bg-card rounded p-4 hover:bg-card/80 transition-colors cursor-pointer h-full flex flex-col" do %>
          <h3 class="text-foreground font-semibold text-sm mb-2 truncate"><%= tag.name %></h3>

          <% if tag.image_url? %>
            <div class="mb-3 flex-grow flex items-center justify-center">
              <img
                src="<%= tag.content.strip %>"
                alt="<%= tag.content.strip %>"
                class="w-full h-40 object-contain rounded"
              >
            </div>
          <% else %>
            <div
              class="
                text-muted-foreground text-xs leading-relaxed mb-3 break-words flex-grow
                overflow-hidden
              "
            >
              <div class="line-clamp-4">
                <%= tag.content %>
              </div>
            </div>
          <% end %>

          <div class="text-muted-foreground text-xs border-t border-border pt-2 mt-auto">
            <span class="block truncate">
              <%= t(".created_by", user: tag.user.name) %>
            </span>
          </div>
        <% end %>
      <% end %>
    </div>
  <% else %>
    <div class="bg-card rounded p-6 text-center">
      <div class="text-6xl mb-4">üè∑Ô∏è</div>
      <h4 class="text-xl font-medium text-foreground mb-2"><%= t(".empty_state.title") %></h4>
      <p class="text-muted-foreground mb-6"><%= t(".empty_state.description") %></p>
    </div>
  <% end %>
<% end %>
